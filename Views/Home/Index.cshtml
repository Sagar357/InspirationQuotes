@{
    ViewBag.Title = "Home Page";
}
@model EverydayPower.Models.Get_Post_List


    <div class="row container-top text-center" >
    </div>


    <div class="container"></div>

        <script>

 function unique(category) {
    return $.grep(category, function(el, index) {
        return index == $.inArray(el, category);
    });
}

    $(document).ready(function () {

        $('#btnSearch').click(function () {
       
            $('.container-top').empty();
            var searchStr = $('#txtSearchBox').val();
            var obj = {
                searchStr: searchStr
            }
            var data = JSON.stringify(obj);
            $.ajax({
                url: '@Url.Action("Search","Home")',
                data: data,
                contentType: 'application/json',
                method: 'post',
                dataType: 'json',
                processData: false,
                async: false,
                success: function (data) {
                    createHtmlLatestItem(data.list);
                },
                error: function (error) {

                    console.log(error);
                }
            });
        });

        $.ajax({
                url: '/Custom_Post/GetAll',
                method: 'get',
                contentType: "application/json",
                dataType:"json",
                processData: false,
                async:false,
            success: function (data) {
               
                    createHtmlLatestItem(data.list);
                },
            error: function (error) {
                console.log(error);
                }
            });

        $('.carousel').carousel();
      
         $('#175Beauty').click(function () {

            var link = '@Url.Action("Index", "Custom_Post")';
            window.location.assign(link);
            });
    });

            var handleClick = () => {

            }

 var createHtmlLatestItem = (data) => {
            
        var id = data[0].seoUrl;

        var html = `
        <div class="col-md-12" style="height:400px;" onclick="location.href='/Quotes/`+id+`';"  >
            <img src='' class="main-image" style=" width: 1500px; height: 500px;" />
        </div>
        <div class=" col-md-12 main-text " style="  float:left; left:6.5em; position:absolute;top:47%; background:black; opacity:0.6; width:35em">
            `+data[0].postUrl+`
            <p>
                Life can feel impossible sometimes. Discover what to do when you feel like giving up. While giving up seems to...
            </p>
        </div>


`;
        $('.container-top').append(html);
        $('.container-top img').attr('src', '../../UploadImage/' + data[0].postIconImage +  '');
        var frameHtml = '<div class="row">';
        var count = 0;
        $('.container').empty();

        var category = [];
        for (var i = 0; i < data.length; i++) {
            category[i] = data[i].category;
        }
     category=unique(category);

       
                    var latestcategory = category[0]
            $.each(data, function (index, value) {
            if (value.category === latestcategory && count < 4) {
                frameHtml = frameHtml + createSubContent(value)
                count++;
                }

        });

        frameHtml = frameHtml + '</div>'

        for (var i = 0; i < category.length; i++) {
            frameHtml = frameHtml + `<div class="row">
            <div class="col-md-4 line"></div>
            <div class="col-md-3 box text-center">
                <span>
                    `+ category[i].toUpperCase() +`
                </span>
            </div>
            <div class="col-md-5 line"></div>
        </div>`;
            count = 0;
            var subhtml = '<div class="row">';
            for (var j = 0; j < data.length; j++) {
                if (data[j].category === category[i]) {
           
                    if (count<2)
                        subhtml = subhtml + createMainSubContent(category[i], data[j]) + `</div>`;
                    else
                        subhtml = subhtml + createSubContent(data[j]) ;
                        count++;

                }
                if (count == 2 && i>0) {
                    subhtml = subhtml+ '<div class="row">';
                }

            }
            subhtml = subhtml + '</div>';
      
            frameHtml = frameHtml + subhtml;
        }

        $('.container').append(frameHtml);

 }

    var createMainSubContent = (cat ,data ,count) => {
        var id = data.seoUrl;
        return `<div class="col-md-6 sub-container" style="margin-bottom:3em;"  onclick="location.href='/Quotes/`+id+`';">
                <img src="../../UploadImage/`+ data.postIconImage +`" class="img-fluid" id="175Beauty" />
                <div class="bottom-left">
                    <p>
                       `+ cat.toUpperCase() +`
                    </p>
                    <span>
                        `+ data.postUrl +`
                    </span>
                </div>`;
    }
             var createSubContent = (value) => {

                 var id = value.seoUrl;
        return `<div class="col-md-3 sub-container"  onclick="location.href='/Quotes/`+id+`';">
                <img width="300" height="200" src="../../UploadImage/` + value.postIconImage + `" />
                <div class="info">
                    <p>
                        `+ value.category.toUpperCase() +`
                    </p>
                    <span>
                        `+ value.postUrl +`
                    </span>
                </div>
            </div>

           `;
    }
        </script>
